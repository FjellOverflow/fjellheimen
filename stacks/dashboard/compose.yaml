name: dashboard
services:
  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    container_name: dashboard-homepage
    user: 1000:1000
    group_add:
      - "996"
    volumes:
      - /fjellheimen/data/dashboard/homepage/config:/app/config
      - /fjellheimen/data/dashboard/homepage/assets:/app/public/assets
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /xdrive:/xdrive
      - /fjellheimen:/fjellheimen
    networks:
      - proxy-network
    env_file:
      - /fjellheimen/stacks/dashboard/.env
    restart: unless-stopped
  glances:
    image: nicolargo/glances:latest
    container_name: dashboard-glances
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    networks:
      - proxy-network
    env_file:
      - /fjellheimen/stacks/.env
    environment:
      - GLANCES_OPT=-w
    privileged: true
    pid: host
    healthcheck:
      test: curl --fail -s http://localhost:61208 || exit 1
      interval: 1m
      start_period: 20s
      timeout: 10s
      retries: 3
    restart: unless-stopped
networks:
  proxy-network:
    external: true
